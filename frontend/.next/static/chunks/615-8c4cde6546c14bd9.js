"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[615],{4615:(e,t,r)=>{r.d(t,{A:()=>d});var s=r(5155),a=r(2115),l=r(6874),o=r.n(l),n=r(5159),c=r(6334),i=r(9514);function d(){var e,t;let[r,l]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),{user:h,isAuthenticated:x,isAdmin:m}=(0,n.As)(),{data:g}=(0,c._)(),p=(0,i.Wn)(),y=(null==g||null==(e=g.data)?void 0:e.totalItems)||0,v=(0,a.useRef)(null),b=()=>{p.mutate()};return(0,a.useEffect)(()=>{let e=e=>{v.current&&!v.current.contains(e.target)&&u(!1)};return d&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[d]),(0,s.jsx)("header",{className:"bg-white shadow-md sticky top-0 z-50",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(o(),{href:"/",className:"text-2xl font-bold text-blue-600",children:"E-Shop"})}),(0,s.jsxs)("nav",{className:"hidden md:flex space-x-8",children:[(0,s.jsx)(o(),{href:"/",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Home"}),x&&(0,s.jsx)(o(),{href:"/products",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Products"}),m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o(),{href:"/dashboard",className:"text-gray-700 hover:text-blue-600 transition-colors",children:"Dashboard"}),(0,s.jsxs)("div",{className:"relative",ref:v,children:[(0,s.jsxs)("button",{onClick:()=>u(!d),className:"text-gray-700 hover:text-blue-600 transition-colors flex items-center",children:["Admin",(0,s.jsx)("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&(0,s.jsxs)("div",{className:"absolute left-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50",children:[(0,s.jsx)(o(),{href:"/products/manage",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>u(!1),children:"Manage Products"}),(0,s.jsx)(o(),{href:"/orders/manage",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>u(!1),children:"Manage Orders"}),(0,s.jsx)(o(),{href:"/admin/users",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>u(!1),children:"Manage Users"}),(0,s.jsx)(o(),{href:"/products/add",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>u(!1),children:"Add Product"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[x&&!m&&(0,s.jsxs)(o(),{href:"/cart",className:"relative p-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h9m-9 0h9"})}),y>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:y})]}),x?(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>l(!r),className:"flex items-center space-x-2 text-gray-700 hover:text-blue-600 transition-colors",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:null==h||null==(t=h.name)?void 0:t.charAt(0).toUpperCase()}),(0,s.jsx)("span",{className:"hidden md:block",children:null==h?void 0:h.name})]}),r&&(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50",children:[(0,s.jsx)(o(),{href:"/user-dashboard",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>l(!1),children:"Dashboard"}),(0,s.jsx)(o(),{href:"/profile",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>l(!1),children:"Profile"}),(0,s.jsx)(o(),{href:"/orders",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>l(!1),children:"Orders"}),(0,s.jsx)("button",{onClick:b,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Logout"})]})]}):(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(o(),{href:"/auth/login",className:"px-4 py-2 text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:"Login"}),(0,s.jsx)(o(),{href:"/auth/register",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Register"})]}),(0,s.jsx)("button",{onClick:()=>l(!r),className:"md:hidden p-2 text-gray-700 hover:text-blue-600",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),r&&(0,s.jsx)("div",{className:"md:hidden py-4 border-t border-gray-200",children:(0,s.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,s.jsx)(o(),{href:"/",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"Home"}),x&&(0,s.jsx)(o(),{href:"/products",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"Products"}),x?(0,s.jsxs)(s.Fragment,{children:[!m&&(0,s.jsxs)(o(),{href:"/cart",className:"text-gray-700 hover:text-blue-600 py-2 flex items-center",onClick:()=>l(!1),children:[(0,s.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h9m-9 0h9"})}),"Cart ",y>0&&"(".concat(y,")")]}),(0,s.jsx)(o(),{href:"/user-dashboard",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"Dashboard"}),(0,s.jsx)(o(),{href:"/profile",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"Profile"}),(0,s.jsx)(o(),{href:"/orders",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"My Orders"}),m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,s.jsx)(o(),{href:"/dashboard",className:"text-gray-700 hover:text-blue-600 py-2",onClick:()=>l(!1),children:"Dashboard"}),(0,s.jsx)(o(),{href:"/products/manage",className:"text-gray-700 hover:text-blue-600 py-2 pl-4",onClick:()=>l(!1),children:"Manage Products"}),(0,s.jsx)(o(),{href:"/orders/manage",className:"text-gray-700 hover:text-blue-600 py-2 pl-4",onClick:()=>l(!1),children:"Manage Orders"}),(0,s.jsx)(o(),{href:"/admin/users",className:"text-gray-700 hover:text-blue-600 py-2 pl-4",onClick:()=>l(!1),children:"Manage Users"}),(0,s.jsx)(o(),{href:"/products/add",className:"text-gray-700 hover:text-blue-600 py-2 pl-4",onClick:()=>l(!1),children:"Add Product"})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,s.jsx)("button",{onClick:()=>{b(),l(!1)},className:"text-left text-red-600 hover:text-red-800 py-2",children:"Logout"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,s.jsx)(o(),{href:"/auth/login",className:"text-blue-600 hover:text-blue-800 py-2",onClick:()=>l(!1),children:"Login"}),(0,s.jsx)(o(),{href:"/auth/register",className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors text-center",onClick:()=>l(!1),children:"Register"})]})]})})]})})}},5159:(e,t,r)=>{r.d(t,{As:()=>o,BG:()=>n,nc:()=>l});var s=r(5453),a=r(6786);let l=(0,s.v)()((0,a.Zr)((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,setUser:t=>{e({user:t,isAuthenticated:!0})},setToken:t=>{e({token:t}),localStorage.setItem("token",t)},login:(t,r)=>{e({user:t,token:r,isAuthenticated:!0,error:null}),localStorage.setItem("token",r),localStorage.setItem("user",JSON.stringify(t))},logout:()=>{e({user:null,token:null,isAuthenticated:!1,error:null}),localStorage.removeItem("token"),localStorage.removeItem("user")},setLoading:t=>{e({isLoading:t})},setError:t=>{e({error:t})},clearError:()=>{e({error:null})},updateUser:r=>{let s=t().user;if(s){let t={...s,...r};e({user:t}),localStorage.setItem("user",JSON.stringify(t))}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})})),o=()=>{var e,t;let r=l();return{user:r.user,token:r.token,isAuthenticated:r.isAuthenticated,isLoading:r.isLoading,error:r.error,isAdmin:(null==(e=r.user)?void 0:e.role)==="admin",isUser:(null==(t=r.user)?void 0:t.role)==="user"}},n=()=>{let e=l();return{setUser:e.setUser,setToken:e.setToken,login:e.login,logout:e.logout,setLoading:e.setLoading,setError:e.setError,clearError:e.clearError,updateUser:e.updateUser}}},5558:(e,t,r)=>{r.d(t,{Ay:()=>a});let s=r(3464).A.create({baseURL:"https://ecommerce-00bz.onrender.com/api",timeout:1e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>Promise.reject(e)),s.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/auth/login"),Promise.reject(e)});let a=s},6334:(e,t,r)=>{r.d(t,{_:()=>o});var s=r(2960),a=r(9950),l=r(5159);let o=()=>{let{token:e}=(0,l.nc)();return(0,s.I)({queryKey:["cart"],queryFn:a.z.getCart,enabled:!!e,staleTime:6e4})}},9514:(e,t,r)=>{r.d(t,{vz:()=>d,Wn:()=>h,LR:()=>u,Cs:()=>m,Sn:()=>x});var s=r(6715),a=r(5041),l=r(5558);let o={login:async e=>(await l.Ay.post("/auth/login",e)).data,register:async e=>(await l.Ay.post("/auth/register",e)).data,updateDetails:async e=>(await l.Ay.put("/auth/updatedetails",e)).data,updatePassword:async e=>(await l.Ay.put("/auth/updatepassword",e)).data,logout:async()=>(await l.Ay.get("/auth/logout")).data};var n=r(5159),c=r(5695),i=r(3568);let d=()=>{let{login:e}=(0,n.BG)(),t=(0,c.useRouter)(),r=(0,s.jE)();return(0,a.n)({mutationFn:o.login,onSuccess:s=>{e(s.data,s.token),r.setQueryData(["auth","me"],{success:!0,data:s.data}),i.oR.success("Login successful!"),t.push("/")},onError:e=>{var t,r;let s=(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Login failed";i.oR.error(s)}})},u=()=>{let{login:e}=(0,n.BG)(),t=(0,c.useRouter)(),r=(0,s.jE)();return(0,a.n)({mutationFn:o.register,onSuccess:s=>{e(s.data,s.token),r.setQueryData(["auth","me"],{success:!0,data:s.data}),i.oR.success("Registration successful!"),t.push("/")},onError:e=>{var t,r;let s=(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Registration failed";i.oR.error(s)}})},h=()=>{let{logout:e}=(0,n.BG)(),t=(0,c.useRouter)(),r=(0,s.jE)();return(0,a.n)({mutationFn:o.logout,onSuccess:()=>{e(),r.clear(),i.oR.success("Logged out successfully"),t.push("/")},onError:()=>{e(),r.clear(),t.push("/")}})},x=()=>{let{updateUser:e}=(0,n.BG)(),t=(0,s.jE)();return(0,a.n)({mutationFn:o.updateDetails,onSuccess:r=>{e(r.data),t.setQueryData(["auth","me"],{success:!0,data:r.data}),i.oR.success("Profile updated successfully!")},onError:e=>{var t,r;let s=(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Update failed";i.oR.error(s)}})},m=()=>(0,a.n)({mutationFn:o.updatePassword,onSuccess:()=>{i.oR.success("Password updated successfully!")},onError:e=>{var t,r;let s=(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||"Password update failed";i.oR.error(s)}})},9950:(e,t,r)=>{r.d(t,{z:()=>a});var s=r(5558);let a={getCart:async()=>(await s.Ay.get("/cart")).data,addToCart:async e=>(await s.Ay.post("/cart/items",e)).data,updateCartItem:async(e,t)=>(await s.Ay.put("/cart/items/".concat(e),t)).data,removeFromCart:async e=>(await s.Ay.delete("/cart/items/".concat(e))).data,clearCart:async()=>(await s.Ay.delete("/cart")).data,validateCart:async()=>(await s.Ay.get("/cart/validate")).data}}}]);